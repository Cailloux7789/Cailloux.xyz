// -------------------
// Ajout de la classe "hasSub" aux li avec sous-menu
$(function(){
  $('.navListe').each( function(){
		$(this).find('li').each(function() 
		{
			if( $(this).find('ul').length > 0) 
			{
				$(this).addClass('hasSub'); // avec sous-menu
			}
		});
  });
});
// -------------------
// Affiche ou cache un dossier :
$(document).on('click', '.navListe li > div.dir', function(event) {
	event.stopPropagation(); // important
  var this_li = $(this).parent('li');
	var this_ul = $(this).parent('li').find('ul:first');

	$('.navListe li').addClass('blurred').removeClass('active');
	this_li.parents('li').addClass('active');

	if( this_ul.length>0 ) // il existe un sous-menu
	{
		if( this_ul.is(':visible') )
		{
			this_ul.fadeOut('slow');
			this_ul.find('ul').fadeOut('slow');
			this_li.removeClass('blurred');
			this_li.siblings('li').removeClass('blurred');
		}
		else
		{
			this_li.siblings('li').find('ul').not(this_ul).fadeOut('slow');
			this_ul.fadeIn('slow').css({'display':'flex'});

			this_li.addClass('blurred active');
			this_li.find('li').removeClass('blurred');
		}
	} else { // pas de sous-menu
		this_li.siblings('li').find('ul').fadeOut('slow');
		this_li.removeClass('blurred');
		this_li.siblings('li').removeClass('blurred');
	}
});
// -------------------
// click sur checkbox :
$(document).on('click', '.navListe li > div input', function(event) {
	event.stopPropagation(); // important
});
// -------------------
// checkAll : check/unchex children
$(document).on('click', '.navListe li > div input.checkAll', function(event) {
	event.stopPropagation(); // important
  $(this).parent().parent().find( 'ul input[type="checkbox"]' ).prop('checked',( $(this).is(':checked') ) );
});
// -------------------
